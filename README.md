# CounterfactualGAN
> Code accompanying the paper [_Generating Realistic Natural Language Counterfactuals_](https://aclanthology.org/2021.findings-emnlp.306.pdf) (Marcel Robeer, Floris Bex and Ad Feelders, 2021).

### Abstract
Counterfactuals are a valuable means for understanding decisions made by machine learning (ML) systems. However, the counterfactuals generated by the methods currently available for natural language text are either unrealistic or introduce imperceptible changes. We propose `CounterfactualGAN`: a method that combines a conditional GAN and the embeddings of a pretrained BERT encoder to model-agnostically generate realistic natural language text counterfactuals for explaining regression and classification tasks. Experimental results show that our method produces perceptibly distinguishable counterfactuals, while outperforming four baseline methods on fidelity and human judgments of naturalness, across multiple datasets and multiple predictive models.

### Software
Download the software directly at https://aclanthology.org/attachments/2021.findings-emnlp.306, under [Software](https://aclanthology.org/attachments/2021.findings-emnlp.306.Software.zip).

### Datasets
CounterfactualGAN is compared against three baseline methods on three datasets (accessible through `dataset.py`):

Dataset | Class | Task | URL | Folder format
---|---|---|---|---
_Hatespeech_ | `Hatespeech()` | Regresssion | [\[url\]](https://data.world/thomasrdavidson/hate-speech-and-offensive-language) | `hatespeech_data.csv`
_SST-2_ | `SST()` | Binary classification | [\[url\]](https://github.com/clairett/pytorch-sentiment-classification/tree/master/data/SST2) | `SST2/*.tsv`
_SNLI_ | `SNLI()` | Three-class classification | [\[url\]](https://archive.nyu.edu/handle/2451/41728) | `snli_1.0/snli_1.0_*.txt`

### Citation
```bibtex
@inproceedings{robeer-etal-2021-generating-realistic,
    title = {Generating Realistic Natural Language Counterfactuals},
    author = {Robeer, Marcel and Bex, Floris and Feelders, Ad},
    booktitle = {Findings of the Association for Computational Linguistics: EMNLP 2021},
    month = nov,
    year = {2021},
    address = {Punta Cana, Dominican Republic},
    publisher = {Association for Computational Linguistics},
    url = {https://aclanthology.org/2021.findings-emnlp.306},
    pages = {3611--3625},
}
```
